for data in ( test_rgb ) return encode(

{ red: (int)(( 255 / ( max((0.5 * (1 - ((data.red*(data.red != 255)) / ((1 - (0.36346516)) * data.red*(data.red != 255) + (0.36346516) * data.red*(data.red != 255)))) * 0.5 * (1 - ((data.red*(data.red != 255)) / ((1 - (0.636167379)) * data.red*(data.red != 255) + (0.636167379) * data.red*(data.red != 255)))))) - min((0.5 * (1 - ((data.red*(data.red != 255)) / ((1 - (0.36346516)) * data.red*(data.red != 255) + (0.36346516) * data.red*(data.red != 255)))) * 0.5 * (1 - ((data.red*(data.red != 255)) / ((1 - (0.636167379)) * data.red*(data.red != 255) + (0.636167379) * data.red*(data.red != 255)))))) )) * ( ((0.5 * (1 - ((data.red*(data.red != 255)) / ((1 - (0.36346516)) * data.red*(data.red != 255) + (0.36346516) * data.red*(data.red != 255)))) * 0.5 * (1 - ((data.red*(data.red != 255)) / ((1 - (0.636167379)) * data.red*(data.red != 255) + (0.636167379) * data.red*(data.red != 255)))))) - min((0.5 * (1 - ((data.red*(data.red != 255)) / ((1 - (0.36346516)) * data.red*(data.red != 255) + (0.36346516) * data.red*(data.red != 255)))) * 0.5 * (1 - ((data.red*(data.red != 255)) / ((1 - (0.636167379)) * data.red*(data.red != 255) + (0.636167379) * data.red*(data.red != 255)))))) ));

green: (int)(( 255 / ( max((1 - ((data.red*(data.red != 255))/((1 - 0.199835775) * (data.red*(data.red != 255)) + (0.199835775) * (data.red*(data.red != 255)))))) - min((1 - ((data.red*(data.red != 255))/((1 - 0.199835775) * (data.red*(data.red != 255)) + (0.199835775) * (data.red*(data.red != 255)))))) )) * ( ((1 - ((data.red*(data.red != 255))/((1 - 0.199835775) * (data.red*(data.red != 255)) + (0.199835775) * (data.red*(data.red != 255)))))) - min((1 - ((data.red*(data.red != 255))/((1 - 0.199835775) * (data.red*(data.red != 255)) + (0.199835775) * (data.red*(data.red != 255)))))) ));

blue: (int)(( 255 / ( max((1 - ((data.red*(data.red != 255))/((1 - 0.199835775) * (data.red*(data.red != 255)) + (0.199835775) * (data.red*(data.red != 255)))))) - min((1 - ((data.red*(data.red != 255))/((1 - 0.199835775) * (data.red*(data.red != 255)) + (0.199835775) * (data.red*(data.red != 255)))))) )) * ( ((1 - ((data.red*(data.red != 255))/((1 - 0.199835775) * (data.red*(data.red != 255)) + (0.199835775) * (data.red*(data.red != 255)))))) - min((1 - ((data.red*(data.red != 255))/((1 - 0.199835775) * (data.red*(data.red != 255)) + (0.199835775) * (data.red*(data.red != 255)))))) ));

alpha: (int)(data.red > 0) * 255},  "png", "nodata=0")
